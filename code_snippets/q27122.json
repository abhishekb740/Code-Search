{
    "title": "How can I fix 'android.os.NetworkOnMainThreadException'?",
    "description": [
        "I got an error while running my Android project for RssReader. ",
        "Code:",
        "URL url = new URL(urlToRssFeed);",
        "SAXParserFactory factory = SAXParserFactory.newInstance();",
        "SAXParser parser = factory.newSAXParser();",
        "XMLReader xmlreader = parser.getXMLReader();",
        "RssHandler theRSSHandler = new RssHandler();",
        "xmlreader.setContentHandler(theRSSHandler);",
        "InputSource is = new InputSource(url.openStream());",
        "xmlreader.parse(is);",
        "return theRSSHandler.getFeed();",
        "And it shows the below error:",
        "android.os.NetworkOnMainThreadException",
        "How can I fix this issue?"
    ],
    "answer": [
        "NOTE : AsyncTask was deprecated in API level 30.",
        "AsyncTask | Android Developers",
        "This exception is thrown when an application attempts to perform a networking operation on its main thread. Run your code in AsyncTask:",
        "class RetrieveFeedTask extends AsyncTask<String, Void, RSSFeed> {",
        "    private Exception exception;",
        "    protected RSSFeed doInBackground(String... urls) {",
        "        try {",
        "            URL url = new URL(urls[0]);",
        "            SAXParserFactory factory = SAXParserFactory.newInstance();",
        "            SAXParser parser = factory.newSAXParser();",
        "            XMLReader xmlreader = parser.getXMLReader();",
        "            RssHandler theRSSHandler = new RssHandler();",
        "            xmlreader.setContentHandler(theRSSHandler);",
        "            InputSource is = new InputSource(url.openStream());",
        "            xmlreader.parse(is);",
        "            return theRSSHandler.getFeed();",
        "        } catch (Exception e) {",
        "            this.exception = e;",
        "            return null;",
        "        } finally {",
        "            is.close();",
        "        }",
        "    }",
        "    protected void onPostExecute(RSSFeed feed) {",
        "        // TODO: check this.exception",
        "        // TODO: do something with the feed",
        "    }",
        "}",
        "How to execute the task:",
        "In MainActivity.java file you can add this line within your oncreate() method",
        "new RetrieveFeedTask().execute(urlToRssFeed);",
        "Don't forget to add this to AndroidManifest.xml file:",
        "<uses-permission android:name=\"android.permission.INTERNET\"/>"
    ]
}